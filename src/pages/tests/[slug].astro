---
import Layout from '../../layouts/Layout.astro';
import TestRenderer from '../../components/TestRenderer.astro';

export async function getStaticPaths() {
  const modules = import.meta.glob('../../data/tests/*.json', { eager: true, as: 'json' });
  return Object.keys(modules).map((path) => {
    const slug = (path.split('/').pop() ?? '').replace('.json', '');
    return { params: { slug } };
  });
}

// Define the expected shape of your test data
type TestData = {
  title: string;
  questions: any[];
  // add other properties if needed
};

const allTests = import.meta.glob('../../data/tests/*.json', { eager: true, as: 'json' });
const slug = Astro.params.slug;
const data = allTests[`../../data/tests/${slug}.json`] as TestData | undefined;

if (!data) {
  throw new Error(`Test "${slug}" no encontrado.`);
}
---
<Layout>
  <h1 class="text-2xl font-bold mb-4">{data.title}</h1>

  <!-- client:load para que React se cargue en el cliente -->
  <TestRenderer client:load questions={data.questions} />

  <p class="mt-6">
    <a href="/" class="text-sm text-gray-600 hover:underline">← Volver al índice</a>
  </p>
</Layout>